"use strict";(self["webpackChunkweek8"]=self["webpackChunkweek8"]||[]).push([[131],{4131:function(t,e,o){o.r(e),o.d(e,{default:function(){return Ot}});var l=o(6252),s=o(3577);const a={class:"container"},d=(0,l._)("h2",null,"後台產品管理列表",-1),i={class:"text-end mt-4"},r={class:"table mt-4"},n=(0,l._)("thead",null,[(0,l._)("tr",null,[(0,l._)("th",{width:"120"},"圖片"),(0,l._)("th",{width:"120"},"分類"),(0,l._)("th",null,"產品名稱"),(0,l._)("th",{width:"120"},"原價"),(0,l._)("th",{width:"120"},"售價"),(0,l._)("th",{width:"100"},"是否啟用"),(0,l._)("th",{width:"120"},"編輯")])],-1),c={style:{width:"200px"}},u={class:"text-end"},p={class:"text-end"},m=["onClick"],h={class:"btn-group"},b=["onClick"],g=["onClick"];function _(t,e,o,_,P,f){const y=(0,l.up)("component-loading"),w=(0,l.up)("page-pagination"),v=(0,l.up)("admin-productModal"),U=(0,l.up)("del-productModal");return(0,l.wg)(),(0,l.iD)("div",a,[(0,l.Wm)(y,{active:P.isLoading},null,8,["active"]),d,(0,l._)("div",i,[(0,l._)("button",{type:"button",class:"btn btn-primary",onClick:e[0]||(e[0]=t=>f.openModal("isNew","item"))}," 建立新的產品 ")]),(0,l._)("table",r,[n,(0,l._)("tbody",null,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(P.products,(t=>((0,l.wg)(),(0,l.iD)("tr",{key:t.id},[(0,l._)("td",c,[(0,l._)("div",{style:(0,s.j5)([{height:"100px","background-size":"cover","background-position":"center"},{backgroundImage:`url(${t.imageUrl})`}])},null,4)]),(0,l._)("td",null,(0,s.zw)(t.category),1),(0,l._)("td",null,(0,s.zw)(t.title),1),(0,l._)("td",u,(0,s.zw)(t.origin_price),1),(0,l._)("td",p,(0,s.zw)(t.price),1),(0,l._)("td",null,[(0,l._)("button",{type:"button",class:(0,s.C_)(["btn btn-sm",{"btn-success":t.is_enabled,"btn-light":!t.is_enabled}]),onClick:e=>t.is_enabled=!t.is_enabled},(0,s.zw)(t.is_enabled?"啟用":"未啟用"),11,m)]),(0,l._)("td",null,[(0,l._)("div",h,[(0,l._)("button",{type:"button",class:"btn btn-outline-primary btn-sm",onClick:e=>f.openModal("edit",t)}," 編輯 ",8,b),(0,l._)("button",{type:"button",class:"btn btn-outline-danger btn-sm",onClick:e=>f.openModal("delete",t)}," 刪除 ",8,g)])])])))),128))])]),(0,l.Wm)(w,{pages:P.pagination,onGetProduct:f.getProducts},null,8,["pages","onGetProduct"]),(0,l.Wm)(v,{product:P.tempProduct,"is-new":P.isNew,ref:"adminProductModal",onGetProducts:f.getProducts},null,8,["product","is-new","onGetProducts"]),(0,l.Wm)(U,{"temp-product":P.tempProduct,ref:"delProductModal",onGetProducts:f.getProducts},null,8,["temp-product","onGetProducts"])])}var P=o(5065),f=o(9963);const y={class:"modal fade",id:"AdminProductModal",ref:"modal",tabindex:"-1","aria-labelledby":"productModalLabel","aria-hidden":"true"},w={class:"modal-dialog modal-xl"},v={class:"modal-content border-0"},U={class:"modal-header bg-dark text-white"},k={id:"productModalLabel",class:"modal-title"},M=(0,l._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),x={class:"modal-body"},$={class:"row"},C={class:"col-sm-4"},N={class:"mb-3"},D=(0,l._)("label",{for:"imageUrl",class:"form-label"},"主要圖片",-1),S={class:"mb-3"},V={for:"customFile",class:"form-label"},L=(0,l.Uk)("或 上傳圖片 "),j={key:0,class:"fas fa-spinner fa-spin"},z=["src","alt"],O=(0,l._)("h3",{class:"mb-3"},"多圖新增",-1),F={key:0},G={class:"mb-1"},I={class:"mb-3"},J=(0,l._)("label",{for:"imageUrl",class:"form-label"},"圖片網址",-1),A=["onUpdate:modelValue"],W=["alt","src"],Z=["onClick"],q={class:"col-sm-8"},H={class:"mb-3"},Y=(0,l._)("label",{for:"title",class:"form-label"},"標題",-1),K={class:"row"},B={class:"mb-3 col-md-6"},T=(0,l._)("label",{for:"category",class:"form-label"},"分類",-1),E={class:"mb-3 col-md-6"},Q=(0,l._)("label",{for:"price",class:"form-label"},"單位",-1),R={class:"row"},X={class:"mb-3 col-md-6"},tt=(0,l._)("label",{for:"origin_price",class:"form-label"},"原價",-1),et={class:"mb-3 col-md-6"},ot=(0,l._)("label",{for:"price",class:"form-label"},"售價",-1),lt=(0,l._)("hr",null,null,-1),st={class:"mb-3"},at=(0,l._)("label",{for:"description",class:"form-label"},"產品描述",-1),dt={class:"mb-3"},it=(0,l._)("label",{for:"content",class:"form-label"},"說明內容",-1),rt={class:"mb-3"},nt={class:"form-check"},ct=(0,l._)("label",{class:"form-check-label",for:"is_enabled"},"是否啟用",-1),ut={class:"modal-footer"},pt=(0,l._)("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function mt(t,e,o,a,d,i){return(0,l.wg)(),(0,l.iD)("div",y,[(0,l._)("div",w,[(0,l._)("div",v,[(0,l._)("div",U,[(0,l._)("h5",k,[(0,l._)("span",null,(0,s.zw)(o.isNew?"新增":"修改")+"產品",1)]),M]),(0,l._)("div",x,[(0,l._)("div",$,[(0,l._)("div",C,[(0,l._)("div",N,[D,(0,l.wy)((0,l._)("input",{type:"text",id:"imageUrl",class:"form-control mb-2","onUpdate:modelValue":e[0]||(e[0]=t=>d.tempProduct.imageUrl=t),placeholder:"請輸入圖片連結"},null,512),[[f.nr,d.tempProduct.imageUrl]]),(0,l._)("div",S,[(0,l._)("label",V,[L,d.status.fileUploading?((0,l.wg)(),(0,l.iD)("i",j)):(0,l.kq)("",!0)]),(0,l._)("input",{type:"file",id:"customFile",class:"form-control",ref:"fileInput",onChange:e[1]||(e[1]=(...t)=>i.uploadFile&&i.uploadFile(...t))},null,544)]),(0,l._)("img",{class:"img-fluid",src:d.tempProduct.imageUrl,alt:d.tempProduct.imageUrl},null,8,z)]),O,Array.isArray(d.tempProduct.imagesUrl)?((0,l.wg)(),(0,l.iD)("div",F,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(d.tempProduct.imagesUrl,((t,e)=>((0,l.wg)(),(0,l.iD)(l.HY,{key:e+"123"},[(0,l._)("div",G,[(0,l._)("div",I,[J,(0,l.wy)((0,l._)("input",{type:"text",class:"form-control","onUpdate:modelValue":t=>d.tempProduct.imagesUrl[e]=t,placeholder:"請輸入圖片連結"},null,8,A),[[f.nr,d.tempProduct.imagesUrl[e]]])]),(0,l._)("img",{class:"img-fluid",alt:d.tempProduct.imagesUrl[e],src:d.tempProduct.imagesUrl[e]},null,8,W)]),(0,l._)("button",{type:"button",class:"btn btn-outline-danger btn-sm d-block w-100",onClick:t=>d.tempProduct.imagesUrl.splice(e,1)}," 刪除 ",8,Z)],64)))),128)),!d.tempProduct.imagesUrl.length||d.tempProduct.imagesUrl[d.tempProduct.imagesUrl.length-1]?((0,l.wg)(),(0,l.iD)("button",{key:0,type:"button",class:"btn btn-outline-primary btn-sm d-block w-100",onClick:e[2]||(e[2]=t=>d.tempProduct.imagesUrl.push(""))}," 新增一張圖片 ")):(0,l.kq)("",!0)])):(0,l.kq)("",!0)]),(0,l._)("div",q,[(0,l._)("div",H,[Y,(0,l.wy)((0,l._)("input",{type:"text",id:"title",class:"form-control","onUpdate:modelValue":e[3]||(e[3]=t=>d.tempProduct.title=t),placeholder:"請輸入標題"},null,512),[[f.nr,d.tempProduct.title]])]),(0,l._)("div",K,[(0,l._)("div",B,[T,(0,l.wy)((0,l._)("input",{type:"text",id:"category",class:"form-control","onUpdate:modelValue":e[4]||(e[4]=t=>d.tempProduct.category=t),placeholder:"請輸入分類"},null,512),[[f.nr,d.tempProduct.category]])]),(0,l._)("div",E,[Q,(0,l.wy)((0,l._)("input",{type:"text",id:"unit",class:"form-control","onUpdate:modelValue":e[5]||(e[5]=t=>d.tempProduct.unit=t),placeholder:"請輸入單位"},null,512),[[f.nr,d.tempProduct.unit]])])]),(0,l._)("div",R,[(0,l._)("div",X,[tt,(0,l.wy)((0,l._)("input",{type:"number",min:"0",id:"origin_price",class:"form-control","onUpdate:modelValue":e[6]||(e[6]=t=>d.tempProduct.origin_price=t),placeholder:"請輸入原價"},null,512),[[f.nr,d.tempProduct.origin_price,void 0,{number:!0}]])]),(0,l._)("div",et,[ot,(0,l.wy)((0,l._)("input",{type:"number",min:"0",id:"price",class:"form-control","onUpdate:modelValue":e[7]||(e[7]=t=>d.tempProduct.price=t),placeholder:"請輸入售價"},null,512),[[f.nr,d.tempProduct.price,void 0,{number:!0}]])])]),lt,(0,l._)("div",st,[at,(0,l.wy)((0,l._)("textarea",{type:"text",id:"description",class:"form-control","onUpdate:modelValue":e[8]||(e[8]=t=>d.tempProduct.description=t),placeholder:"請輸入產品描述"},"\n                ",512),[[f.nr,d.tempProduct.description]])]),(0,l._)("div",dt,[it,(0,l.wy)((0,l._)("textarea",{type:"text",id:"description",class:"form-control","onUpdate:modelValue":e[9]||(e[9]=t=>d.tempProduct.content=t),placeholder:"請輸入說明內容"},"\n                ",512),[[f.nr,d.tempProduct.content]])]),(0,l._)("div",rt,[(0,l._)("div",nt,[(0,l.wy)((0,l._)("input",{type:"checkbox",id:"is_enabled",class:"form-check-input","onUpdate:modelValue":e[10]||(e[10]=t=>d.tempProduct.is_enabled=t),"true-value":1,"false-value":0},null,512),[[f.e8,d.tempProduct.is_enabled]]),ct])])])])]),(0,l._)("div",ut,[pt,(0,l._)("button",{type:"button",class:"btn btn-primary",onClick:e[11]||(e[11]=t=>i.updateProduct())}," 確認 ")])])])],512)}var ht=o(7424),bt=o.n(ht),gt={props:{product:{type:Object,default(){return{}}},isNew:{type:Boolean,default:!1}},data(){return{modal:{},id:"",isLoading:!1,tempProduct:{imagesUrl:[]},status:{}}},inject:["emitter"],methods:{uploadFile(){const t=this.$refs.fileInput.files[0],e=new FormData;e.append("file-to-upload",t);const o="https://vue3-course-api.hexschool.io/v2/api/jesse-hexschool/admin/upload";this.status.fileUploading=!0,this.$http.post(o,e,{headers:{"Content-Type":"multipart/form-data"}}).then((t=>{this.status.fileUploading=!1,t.data.success?(this.tempProduct.imageUrl=t.data.imageUrl,this.$refs.fileInput.value="",this.emitter.emit("push-message",{style:"success",title:"圖片上傳結果",content:t.data.message})):(this.$refs.fileInput.value="",this.emitter.emit("push-message",{style:"danger",title:"圖片上傳結果",content:t.data.message}))})).catch((t=>{this.status.fileUploading=!1,this.$httpMessageState(t.response,"圖片失敗")}))},updateProduct(){let t="https://vue3-course-api.hexschool.io/v2/api/jesse-hexschool/admin/product",e="post",o="新增產品";this.isNew||(t=`https://vue3-course-api.hexschool.io/v2/api/jesse-hexschool/admin/product/${this.tempProduct.id}`,e="put",o="更新產品"),this.$http[e](t,{data:this.tempProduct}).then((t=>{this.adminProductModal.hide(),this.$httpMessageState(t,o),this.$emit("get-products")})).catch((t=>{this.$httpMessageState(t.response,o)}))},openModal(){this.adminProductModal.show()},closeModal(){this.adminProductModal.hide()}},watch:{product(){this.tempProduct=JSON.parse(JSON.stringify(this.product))}},mounted(){this.adminProductModal=new(bt())(this.$refs.modal,{keyboard:!1,backdrop:"static"})}},_t=o(3744);const Pt=(0,_t.Z)(gt,[["render",mt]]);var ft=Pt;const yt={class:"modal fade",id:"DelProductModal",ref:"modal",tabindex:"-1","aria-labelledby":"delProductModalLabel","aria-hidden":"true"},wt={class:"modal-dialog"},vt={class:"modal-content border-0"},Ut=(0,l._)("div",{class:"modal-header bg-danger text-white"},[(0,l._)("h5",{id:"delProductModalLabel",class:"modal-title"},[(0,l._)("span",null,"刪除產品")]),(0,l._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),kt={class:"modal-body"},Mt=(0,l.Uk)(" 是否刪除 "),xt={class:"text-danger"},$t=(0,l.Uk)(" 商品(刪除後將無法恢復)。 "),Ct={class:"modal-footer"},Nt=(0,l._)("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function Dt(t,e,o,a,d,i){return(0,l.wg)(),(0,l.iD)("div",yt,[(0,l._)("div",wt,[(0,l._)("div",vt,[Ut,(0,l._)("div",kt,[Mt,(0,l._)("strong",xt,(0,s.zw)(o.tempProduct.title),1),$t]),(0,l._)("div",Ct,[Nt,(0,l._)("button",{type:"button",class:"btn btn-danger",onClick:e[0]||(e[0]=(...t)=>i.delProduct&&i.delProduct(...t))}," 確認刪除 ")])])])],512)}var St={props:["tempProduct"],methods:{delProduct(){const t=`https://vue3-course-api.hexschool.io/v2/api/jesse-hexschool/admin/product/${this.tempProduct.id}`;this.$http.delete(t).then((t=>{this.$emit("get-products"),this.delProductModal.hide(),this.$httpMessageState(t,"刪除產品")})).catch((t=>{this.$httpMessageState(t.response,"錯誤訊息")}))},openModal(){this.delProductModal.show()},closeModal(){this.delProductModal.hide()}},mounted(){this.delProductModal=new(bt())(this.$refs.modal,{keyboard:!1,backdrop:"static"})}};const Vt=(0,_t.Z)(St,[["render",Dt]]);var Lt=Vt,jt={data(){return{products:[],isLoadingItem:"",isLoading:!1,isNew:!1,tempProduct:{imagesUrl:[]},status:{fileUploading:!1},modal:{AdminProductModal:"",DelProductModal:""},pagination:{}}},components:{PagePagination:P.Z,AdminProductModal:ft,DelProductModal:Lt},methods:{getProducts(t=1){this.isLoading=!0;const e=`https://vue3-course-api.hexschool.io/v2/api/jesse-hexschool/admin/products?page=${t}`;this.$http.get(e).then((t=>{console.log(t),this.products=t.data.products,this.isLoading=!1,this.pagination=t.data.pagination})).catch((t=>{this.$httpMessageState(t.response,"錯誤訊息")}))},openModal(t,e){console.log(t,e),"isNew"===t?(this.tempProduct={imagesUrl:[]},this.isNew=!0,this.$refs.adminProductModal.openModal()):"edit"===t?(this.tempProduct=JSON.parse(JSON.stringify(e)),this.isNew=!1,this.$refs.adminProductModal.openModal(),this.tempProduct.imagesUrl||(this.tempProduct.imagesUrl=[])):"delete"===t&&(this.tempProduct=JSON.parse(JSON.stringify(e)),this.$refs.delProductModal.openModal())}},mounted(){this.getProducts()}};const zt=(0,_t.Z)(jt,[["render",_]]);var Ot=zt}}]);
//# sourceMappingURL=131.e8c94c34.js.map