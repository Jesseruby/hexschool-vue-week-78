"use strict";(self["webpackChunkweek8"]=self["webpackChunkweek8"]||[]).push([[131],{2251:function(t,e,l){l.d(e,{Z:function(){return _}});var a=l(3396),o=l(7139),s=l(9242);const i={"aria-label":"Page navigation example",class:"mt-3 d-flex justify-content-center"},d={class:"pagination"},r=(0,a._)("span",{"aria-hidden":"true"},"«",-1),n=[r],c=["onClick"],u=(0,a._)("span",{"aria-hidden":"true"},"»",-1),p=[u];function m(t,e,l,r,u,m){return(0,a.wg)(),(0,a.iD)("nav",i,[(0,a._)("ul",d,[(0,a._)("li",{class:(0,o.C_)(["page-item",{disabled:!l.pages.has_pre}])},[(0,a._)("a",{class:"page-link","aria-label":"Previous",href:"#",onClick:e[0]||(e[0]=(0,s.iM)((e=>t.$emit("get-product",l.pages.current_page-1)),["prevent"]))},n)],2),((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(l.pages.total_pages,(e=>((0,a.wg)(),(0,a.iD)("li",{class:(0,o.C_)(["page-item",{active:e===l.pages.current_page}]),key:e+"123"},[(0,a._)("a",{class:"page-link",href:"#",onClick:(0,s.iM)((l=>t.$emit("get-product",e)),["prevent"])},(0,o.zw)(e),9,c)],2)))),128)),(0,a._)("li",{class:(0,o.C_)(["page-item",{disabled:!l.pages.has_next}])},[(0,a._)("a",{class:"page-link",href:"#","aria-label":"Next",onClick:e[1]||(e[1]=(0,s.iM)((e=>t.$emit("get-product",l.pages.current_page+1)),["prevent"]))},p)],2)])])}var h={props:["pages"]},b=l(89);const g=(0,b.Z)(h,[["render",m]]);var _=g},4131:function(t,e,l){l.r(e),l.d(e,{default:function(){return Ot}});var a=l(3396),o=l(7139);const s={class:"container"},i=(0,a._)("h2",null,"後台產品管理列表",-1),d={class:"text-end mt-4"},r={class:"table mt-4"},n=(0,a._)("thead",null,[(0,a._)("tr",null,[(0,a._)("th",{width:"120"},"圖片"),(0,a._)("th",{width:"120"},"分類"),(0,a._)("th",null,"產品名稱"),(0,a._)("th",{width:"120"},"原價"),(0,a._)("th",{width:"120"},"售價"),(0,a._)("th",{width:"100"},"是否啟用"),(0,a._)("th",{width:"120"},"編輯")])],-1),c={style:{width:"200px"}},u={class:"text-end"},p={class:"text-end"},m=["onClick"],h={class:"btn-group"},b=["onClick"],g=["onClick"];function _(t,e,l,_,f,P){const v=(0,a.up)("component-loading"),y=(0,a.up)("page-pagination"),w=(0,a.up)("admin-productModal"),k=(0,a.up)("del-productModal");return(0,a.wg)(),(0,a.iD)("div",s,[(0,a.Wm)(v,{active:f.isLoading},null,8,["active"]),i,(0,a._)("div",d,[(0,a._)("button",{type:"button",class:"btn btn-primary",onClick:e[0]||(e[0]=t=>P.openModal("isNew","item"))}," 建立新的產品 ")]),(0,a._)("table",r,[n,(0,a._)("tbody",null,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(f.products,(t=>((0,a.wg)(),(0,a.iD)("tr",{key:t.id},[(0,a._)("td",c,[(0,a._)("div",{style:(0,o.j5)([{height:"100px","background-size":"cover","background-position":"center"},{backgroundImage:`url(${t.imageUrl})`}])},null,4)]),(0,a._)("td",null,(0,o.zw)(t.category),1),(0,a._)("td",null,(0,o.zw)(t.title),1),(0,a._)("td",u,(0,o.zw)(t.origin_price),1),(0,a._)("td",p,(0,o.zw)(t.price),1),(0,a._)("td",null,[(0,a._)("button",{type:"button",class:(0,o.C_)(["btn btn-sm",{"btn-success":t.is_enabled,"btn-light":!t.is_enabled}]),onClick:e=>t.is_enabled=!t.is_enabled},(0,o.zw)(t.is_enabled?"啟用":"未啟用"),11,m)]),(0,a._)("td",null,[(0,a._)("div",h,[(0,a._)("button",{type:"button",class:"btn btn-outline-primary btn-sm",onClick:e=>P.openModal("edit",t)}," 編輯 ",8,b),(0,a._)("button",{type:"button",class:"btn btn-outline-danger btn-sm",onClick:e=>P.openModal("delete",t)}," 刪除 ",8,g)])])])))),128))])]),(0,a.Wm)(y,{pages:f.pagination,onGetProduct:P.getProducts},null,8,["pages","onGetProduct"]),(0,a.Wm)(w,{product:f.tempProduct,"is-new":f.isNew,ref:"adminProductModal",onGetProducts:P.getProducts},null,8,["product","is-new","onGetProducts"]),(0,a.Wm)(k,{"temp-product":f.tempProduct,ref:"delProductModal",onGetProducts:P.getProducts},null,8,["temp-product","onGetProducts"])])}var f=l(2251),P=l(9242);const v={class:"modal fade",id:"AdminProductModal",ref:"modal",tabindex:"-1","aria-labelledby":"productModalLabel","aria-hidden":"true"},y={class:"modal-dialog modal-xl"},w={class:"modal-content border-0"},k={class:"modal-header bg-dark text-white"},M={id:"productModalLabel",class:"modal-title"},U=(0,a._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),x={class:"modal-body"},$={class:"row"},C={class:"col-sm-4"},D={class:"mb-3"},N=(0,a._)("label",{for:"imageUrl",class:"form-label"},"主要圖片",-1),S={class:"mb-3"},V={for:"customFile",class:"form-label"},L=(0,a.Uk)("或 上傳圖片 "),j={key:0,class:"fas fa-spinner fa-spin"},z=["src","alt"],O=(0,a._)("h3",{class:"mb-3"},"多圖新增",-1),F={key:0},G={class:"mb-1"},I={class:"mb-3"},J=(0,a._)("label",{for:"imageUrl",class:"form-label"},"圖片網址",-1),Z=["onUpdate:modelValue"],A=["alt","src"],H=["onClick"],W={class:"col-sm-8"},Y={class:"mb-3"},q=(0,a._)("label",{for:"title",class:"form-label"},"標題",-1),K={class:"row"},B={class:"mb-3 col-md-6"},T=(0,a._)("label",{for:"category",class:"form-label"},"分類",-1),E={class:"mb-3 col-md-6"},Q=(0,a._)("label",{for:"price",class:"form-label"},"單位",-1),R={class:"row"},X={class:"mb-3 col-md-6"},tt=(0,a._)("label",{for:"origin_price",class:"form-label"},"原價",-1),et={class:"mb-3 col-md-6"},lt=(0,a._)("label",{for:"price",class:"form-label"},"售價",-1),at=(0,a._)("hr",null,null,-1),ot={class:"mb-3"},st=(0,a._)("label",{for:"description",class:"form-label"},"產品描述",-1),it={class:"mb-3"},dt=(0,a._)("label",{for:"content",class:"form-label"},"說明內容",-1),rt={class:"mb-3"},nt={class:"form-check"},ct=(0,a._)("label",{class:"form-check-label",for:"is_enabled"},"是否啟用",-1),ut={class:"modal-footer"},pt=(0,a._)("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function mt(t,e,l,s,i,d){return(0,a.wg)(),(0,a.iD)("div",v,[(0,a._)("div",y,[(0,a._)("div",w,[(0,a._)("div",k,[(0,a._)("h5",M,[(0,a._)("span",null,(0,o.zw)(l.isNew?"新增":"修改")+"產品",1)]),U]),(0,a._)("div",x,[(0,a._)("div",$,[(0,a._)("div",C,[(0,a._)("div",D,[N,(0,a.wy)((0,a._)("input",{type:"text",id:"imageUrl",class:"form-control mb-2","onUpdate:modelValue":e[0]||(e[0]=t=>i.tempProduct.imageUrl=t),placeholder:"請輸入圖片連結"},null,512),[[P.nr,i.tempProduct.imageUrl]]),(0,a._)("div",S,[(0,a._)("label",V,[L,i.status.fileUploading?((0,a.wg)(),(0,a.iD)("i",j)):(0,a.kq)("",!0)]),(0,a._)("input",{type:"file",id:"customFile",class:"form-control",ref:"fileInput",onChange:e[1]||(e[1]=(...t)=>d.uploadFile&&d.uploadFile(...t))},null,544)]),(0,a._)("img",{class:"img-fluid",src:i.tempProduct.imageUrl,alt:i.tempProduct.imageUrl},null,8,z)]),O,Array.isArray(i.tempProduct.imagesUrl)?((0,a.wg)(),(0,a.iD)("div",F,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(i.tempProduct.imagesUrl,((t,e)=>((0,a.wg)(),(0,a.iD)(a.HY,{key:e+"123"},[(0,a._)("div",G,[(0,a._)("div",I,[J,(0,a.wy)((0,a._)("input",{type:"text",class:"form-control","onUpdate:modelValue":t=>i.tempProduct.imagesUrl[e]=t,placeholder:"請輸入圖片連結"},null,8,Z),[[P.nr,i.tempProduct.imagesUrl[e]]])]),(0,a._)("img",{class:"img-fluid",alt:i.tempProduct.imagesUrl[e],src:i.tempProduct.imagesUrl[e]},null,8,A)]),(0,a._)("button",{type:"button",class:"btn btn-outline-danger btn-sm d-block w-100",onClick:t=>i.tempProduct.imagesUrl.splice(e,1)}," 刪除 ",8,H)],64)))),128)),!i.tempProduct.imagesUrl.length||i.tempProduct.imagesUrl[i.tempProduct.imagesUrl.length-1]?((0,a.wg)(),(0,a.iD)("button",{key:0,type:"button",class:"btn btn-outline-primary btn-sm d-block w-100",onClick:e[2]||(e[2]=t=>i.tempProduct.imagesUrl.push(""))}," 新增一張圖片 ")):(0,a.kq)("",!0)])):(0,a.kq)("",!0)]),(0,a._)("div",W,[(0,a._)("div",Y,[q,(0,a.wy)((0,a._)("input",{type:"text",id:"title",class:"form-control","onUpdate:modelValue":e[3]||(e[3]=t=>i.tempProduct.title=t),placeholder:"請輸入標題"},null,512),[[P.nr,i.tempProduct.title]])]),(0,a._)("div",K,[(0,a._)("div",B,[T,(0,a.wy)((0,a._)("input",{type:"text",id:"category",class:"form-control","onUpdate:modelValue":e[4]||(e[4]=t=>i.tempProduct.category=t),placeholder:"請輸入分類"},null,512),[[P.nr,i.tempProduct.category]])]),(0,a._)("div",E,[Q,(0,a.wy)((0,a._)("input",{type:"text",id:"unit",class:"form-control","onUpdate:modelValue":e[5]||(e[5]=t=>i.tempProduct.unit=t),placeholder:"請輸入單位"},null,512),[[P.nr,i.tempProduct.unit]])])]),(0,a._)("div",R,[(0,a._)("div",X,[tt,(0,a.wy)((0,a._)("input",{type:"number",min:"0",id:"origin_price",class:"form-control","onUpdate:modelValue":e[6]||(e[6]=t=>i.tempProduct.origin_price=t),placeholder:"請輸入原價"},null,512),[[P.nr,i.tempProduct.origin_price,void 0,{number:!0}]])]),(0,a._)("div",et,[lt,(0,a.wy)((0,a._)("input",{type:"number",min:"0",id:"price",class:"form-control","onUpdate:modelValue":e[7]||(e[7]=t=>i.tempProduct.price=t),placeholder:"請輸入售價"},null,512),[[P.nr,i.tempProduct.price,void 0,{number:!0}]])])]),at,(0,a._)("div",ot,[st,(0,a.wy)((0,a._)("textarea",{type:"text",id:"description",class:"form-control","onUpdate:modelValue":e[8]||(e[8]=t=>i.tempProduct.description=t),placeholder:"請輸入產品描述"},"\n                ",512),[[P.nr,i.tempProduct.description]])]),(0,a._)("div",it,[dt,(0,a.wy)((0,a._)("textarea",{type:"text",id:"description",class:"form-control","onUpdate:modelValue":e[9]||(e[9]=t=>i.tempProduct.content=t),placeholder:"請輸入說明內容"},"\n                ",512),[[P.nr,i.tempProduct.content]])]),(0,a._)("div",rt,[(0,a._)("div",nt,[(0,a.wy)((0,a._)("input",{type:"checkbox",id:"is_enabled",class:"form-check-input","onUpdate:modelValue":e[10]||(e[10]=t=>i.tempProduct.is_enabled=t),"true-value":1,"false-value":0},null,512),[[P.e8,i.tempProduct.is_enabled]]),ct])])])])]),(0,a._)("div",ut,[pt,(0,a._)("button",{type:"button",class:"btn btn-primary",onClick:e[11]||(e[11]=t=>d.updateProduct())}," 確認 ")])])])],512)}var ht=l(7972),bt=l.n(ht),gt={props:{product:{type:Object,default(){return{}}},isNew:{type:Boolean,default:!1}},data(){return{modal:{},id:"",isLoading:!1,tempProduct:{imagesUrl:[]},status:{}}},inject:["emitter"],methods:{uploadFile(){const t=this.$refs.fileInput.files[0],e=new FormData;e.append("file-to-upload",t);const l="https://vue3-course-api.hexschool.io/v2/api/jesse-hexschool/admin/upload";this.status.fileUploading=!0,this.$http.post(l,e,{headers:{"Content-Type":"multipart/form-data"}}).then((t=>{this.status.fileUploading=!1,t.data.success?(this.tempProduct.imageUrl=t.data.imageUrl,this.$refs.fileInput.value="",this.emitter.emit("push-message",{style:"success",title:"圖片上傳結果",content:t.data.message})):(this.$refs.fileInput.value="",this.emitter.emit("push-message",{style:"danger",title:"圖片上傳結果",content:t.data.message}))})).catch((t=>{this.status.fileUploading=!1,this.$httpMessageState(t.response,"圖片失敗")}))},updateProduct(){let t="https://vue3-course-api.hexschool.io/v2/api/jesse-hexschool/admin/product",e="post",l="新增產品";this.isNew||(t=`https://vue3-course-api.hexschool.io/v2/api/jesse-hexschool/admin/product/${this.tempProduct.id}`,e="put",l="更新產品"),this.$http[e](t,{data:this.tempProduct}).then((t=>{this.adminProductModal.hide(),this.$httpMessageState(t,l),this.$emit("get-products")})).catch((t=>{this.$httpMessageState(t.response,l)}))},openModal(){this.adminProductModal.show()},closeModal(){this.adminProductModal.hide()}},watch:{product(){this.tempProduct=JSON.parse(JSON.stringify(this.product))}},mounted(){this.adminProductModal=new(bt())(this.$refs.modal,{keyboard:!1,backdrop:"static"})}},_t=l(89);const ft=(0,_t.Z)(gt,[["render",mt]]);var Pt=ft;const vt={class:"modal fade",id:"DelProductModal",ref:"modal",tabindex:"-1","aria-labelledby":"delProductModalLabel","aria-hidden":"true"},yt={class:"modal-dialog"},wt={class:"modal-content border-0"},kt=(0,a._)("div",{class:"modal-header bg-danger text-white"},[(0,a._)("h5",{id:"delProductModalLabel",class:"modal-title"},[(0,a._)("span",null,"刪除產品")]),(0,a._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),Mt={class:"modal-body"},Ut=(0,a.Uk)(" 是否刪除 "),xt={class:"text-danger"},$t=(0,a.Uk)(" 商品(刪除後將無法恢復)。 "),Ct={class:"modal-footer"},Dt=(0,a._)("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function Nt(t,e,l,s,i,d){return(0,a.wg)(),(0,a.iD)("div",vt,[(0,a._)("div",yt,[(0,a._)("div",wt,[kt,(0,a._)("div",Mt,[Ut,(0,a._)("strong",xt,(0,o.zw)(l.tempProduct.title),1),$t]),(0,a._)("div",Ct,[Dt,(0,a._)("button",{type:"button",class:"btn btn-danger",onClick:e[0]||(e[0]=(...t)=>d.delProduct&&d.delProduct(...t))}," 確認刪除 ")])])])],512)}var St={props:["tempProduct"],methods:{delProduct(){const t=`https://vue3-course-api.hexschool.io/v2/api/jesse-hexschool/admin/product/${this.tempProduct.id}`;this.$http.delete(t).then((t=>{this.$emit("get-products"),this.delProductModal.hide(),this.$httpMessageState(t,"刪除產品")})).catch((t=>{this.$httpMessageState(t.response,"錯誤訊息")}))},openModal(){this.delProductModal.show()},closeModal(){this.delProductModal.hide()}},mounted(){this.delProductModal=new(bt())(this.$refs.modal,{keyboard:!1,backdrop:"static"})}};const Vt=(0,_t.Z)(St,[["render",Nt]]);var Lt=Vt,jt={data(){return{products:[],isLoadingItem:"",isLoading:!1,isNew:!1,tempProduct:{imagesUrl:[]},status:{fileUploading:!1},modal:{AdminProductModal:"",DelProductModal:""},pagination:{}}},components:{PagePagination:f.Z,AdminProductModal:Pt,DelProductModal:Lt},methods:{getProducts(t=1){this.isLoading=!0;const e=`https://vue3-course-api.hexschool.io/v2/api/jesse-hexschool/admin/products?page=${t}`;this.$http.get(e).then((t=>{console.log(t),this.products=t.data.products,this.isLoading=!1,this.pagination=t.data.pagination})).catch((t=>{this.$httpMessageState(t.response,"錯誤訊息")}))},openModal(t,e){console.log(t,e),"isNew"===t?(this.tempProduct={imagesUrl:[]},this.isNew=!0,this.$refs.adminProductModal.openModal()):"edit"===t?(this.tempProduct=JSON.parse(JSON.stringify(e)),this.isNew=!1,this.$refs.adminProductModal.openModal(),this.tempProduct.imagesUrl||(this.tempProduct.imagesUrl=[])):"delete"===t&&(this.tempProduct=JSON.parse(JSON.stringify(e)),this.$refs.delProductModal.openModal())}},mounted(){this.getProducts()}};const zt=(0,_t.Z)(jt,[["render",_]]);var Ot=zt}}]);
//# sourceMappingURL=131.57eeefab.js.map